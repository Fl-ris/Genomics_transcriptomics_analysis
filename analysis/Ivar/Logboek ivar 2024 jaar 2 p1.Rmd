---
title: "Logboek Ivar Jaar 2 P1"
author: "Ivar"
date: "2024-09-10"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# project introductie
Dit logboek is voor het project genomics en transcriptomics in het thema aging. Hiervoor hebben wij het onderzoek Three-dimensional chromatin reorganization regulates B cell development during ageing gebruikt. Hiervan nemen wij de genomische en transcriptomische onderdelen voor onze onderzoeksvraag "Zijn er genetische varianten te vinden in het embf1 en pax5 gen te vinden dat het vorige onderzoek kan beinvloeden"

#opzet

doel van de dag, wat en hoe heb je gedaan, commando's, resultaten


# Library chunk
```{r}
library(fastqcr)
```


# Week 1
# doel project genomics and aging
## Wat en waarom
In de eerste 2 lessen hebben we als groep gezocht naar potentieel onderzoek dat wij kunnen gebruiken voor het project. Het thema dat wij hiervoor hebben gekozen is aging omdat dit ons een interessant lijkt. 
Om een gepast onderzoek te kiezen hebben wij allemaal in de GEO-Datasets van NCBI geken en voor ons interessante onderzoek door te lezen en in onze teams omgeving te posten. daarna hebben wij elkaars alle abstracten van iedereens onderzoek gelezen en een onderzoek uitgekozen om voor te leggen aan marcel.
het onderzoek dat we hebben gekozen na overleg met Marcel is "Three-dimensional chromatin 
reorganization regulates B cell development 
during ageing".
De links hiervoor staan bij resultaten.
hierna hebben wij een taakverdeling gemaakt om het werk eerlijk te verdelen. Mijn taak voor de voorbereiden van de plan van aanpak presentatie is het ontleden en uitleggen van de onderzoeksvraag en het maken van een Gant chart gemaakt.

### Uitleg Onderzoeksvraag
Onderzoeksvraag van het orinele onderzoek
Wat is invloed van chromatine vormverandering op prognater b cellen?
De verwachting is dat doormiddel van veroudering verandering in de TAD (topologically 
associated domains) genen die belangrijk zijn voor de regulatie van B cellen verschuiven van het hoog actieve A compartiment naar het onderdrukte B compartiment verschuiven. Dit kan een belangrijke verklaring kunnen zijn waarom er minder is transcriptie op dit gebied in oudere dieren.

### Notitie's
https://www.youtube.com/watch?v=uakxc0_Dec4 uitleg TAD A/B compartments. de HI-c methode heeft ontdekt dat in het chromatine zich in meer domeinen vormt dan verwacht. op het moment is de er een lopende theorie dat het chromatine zich scheidt in a en b compartementen. 
A compartement
het A compertement is het hoogactieve compartiment waar vaak genen zitten die vaak getranscribeerd worden. hieren in veel interactie tussen promoters en de genen in dit compartiment zonder dat dit een ander compartiment beinvloed.
B compartement.
het B compartement is het laagactieve compartiment. Hierin zitten vaak de onderdrukte genen en/of unieke/"junk" genen.

## Vrijdag 
gezamenlijk de genomics data van ons onderzoek gedownload als SRA files en onze project map neergezet om volgende week uit te pakken zodat we dit kunnen gebruiken in ons onderzoek.
De SRA files staan in de SRA map "/students/2024-2025/Thema05/3Dchromatine/SRA"
SRA staat voor Sequence Read Archives het is een ruw data archief voor sequencing bestanden met met een kwaliteits score per sequence zoals fastq bestanden. (https://www.ncbi.nlm.nih.gov/sra/docs/submitformats/).

## resultaten
onderzoek links
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC11178499/pdf/41556_2024_Article_1424.pdf
https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE214438
Gant chart staat in teams map school.
Uitleg onderzoeksvraag staat hierboven vermeld en in teams map onderzoek.
SRA files in de map "/students/2024-2025/Thema05/3Dchromatine/SRA"


# Week 2

## Maandag 
Na de groepenpresentaties hebben wij we gezamenlijk de genomics data uitgepakt met de tool fasterqdump via floris zijn laptop.
# floris zijn code
```{r EVAL=FALSE}

```

### seqtk test dataset 
Met floris zijn code een fastq data set gemaakt met 10 000 lines 
deze hoeveelhijd lines hebben wij gedaan op advies van ronald 

# floris zijn code
```{r EVAL=FALSE}

```

### fastqc en trimmomatic edit uitleg fastqc en trimmotic wat gedaan
ik en storm hebben wij de taken fastqc en trimmomatic pipeline gekregen omdat wij vorig jaar in een eerder project hiermee hebben gewerkt. Fastqc[1] gebruiken wij om de kwaliteit van de sequentie's te analyseren en Trimmomatic[2] gebruiken wij om de sequenties de van te lage kwaliteit zijn te verwijderen.

### Resultaten
Taakverdeling gemaakt
Begin gemaakt aan het Fastqc commando
Geholpen met test dataset in map fastq/test_data

## Dinsdag
fastqc en multiqc vandaag verder uitgewerkt en het commando uitgevoerd zodat wij kunnen kijken wat de kwaliteit van de samples is. Hiervoor hebben wij de R library fastqcr gebruikt, omdat dit de R versie is van fastqc. Nadat dit programma klaar was hebben we multiqc gerund voor een overzicht van al onze data 

### Uitleg FastQC
FastQC is een kwaliteits controle programma voor sequentie data gegeneerd uit next generation sequencing apparaten. dit programma kan je een indruk geven van de kwaliteit van jouw data en waar eventuele problemen liggen. 
Het doet dit doormiddel van het analyseren van de fastq file die gegenereerd word door de sequincer. dit bestand bestaad uit een header begginnent met @ gevolgd door een identifier en een optionele input, in de volgende rij komt de sequentie letters. De derde rij begint met een + bevat optioneel de identifier, en de vierde rij bevat een kwaliteit score per base in ASCII caracters aan de hand van hoe zeker de sequencer is per base.
1 van deze plots die fastqc weergeeft is de "per base sequence quality" dit plot geeft de algemene kwaliteit per nucleotide base weer aan de hand van hoe zeker het sequencer apparaat dit heeft meegegeven in de fastq file.
Aan de hand hiervan kun je de gemiddelde kwaliteit van jouw sample bestuderen en beslissen of jouw data betrouwbaar is of niet.
Versie 

#### Uitleg MultiQC
Het doel van MultiQC is om in 1 bestand een overzicht te krijgen als je meerdere bestanden hebt waarvan je de kwaliteit wil weten, Dit programma maakt hiervoor een overzicht

### Uitleg Trimmomatic
Trimmomatic is een data procesing programma voor fastq files. Wat trimmomatic doet is aan de hand van de meegegeven opties verwijderd sequentie data dat van eventuele slechte kwaliteit is. voorbeelden van de opties die je mee kunt geven aan dit programme zijn:
Sliding window(base lengte : kwaliteit score) deze optie scant een opgegeven hoeveelheid basen en verwijderd deze als ze onder de opgegeven kwaliteit komen.
Iluminaclip verwijderd adapters en andere ilumina specifieke sequenties van de read.

### FastQC en MultiQC run 
Hieronder het automation script voor fastqc run in de fastq map

```{r eval=FALSE}
# getwd
setwd("/students/2024-2025/Thema05/3dconformatieChromatine/fastq")
(x = getwd())
fastqc(fq.dir = x, qc.dir = "/students/2024-2025/Thema05/3dconformatieChromatine/fastqc_output/", fastqc.path = "/usr/bin/fastqc", threads = 100)
```

MultiQC command

```{bash, eval=FALSE}
pwd
cd ../
cd fastqc_output
pwd
multiqc .
```

### multiqc resultaten

![General statatistics multicq](../Logboek_recources/fastqc/multiqc_ruw_gen_stats.png)
Uit de general statistics plot kan ik halen dat de download van de eerste sample mislukt is. Ook bevatten de eerste 4 samples en hun reverse componenten ruim 90% duplicaten wat dramatisch slecht is.

![seq quality](../Logboek_recources/fastqc/multiqc_ruw_seq_quality.png)
De kwaliteit per base plot laat zien dat de samples met de 90% duplicates ook van best slechte kwaliteit zijn. ook is het biezonder dat de gehighlighte sample een sprong in kwaliteit maakt. de normale verwachting is dat de lijn in de kwaliteit een soort banaan vorm heeft. de samples die minder dan 90% duplicates hebben lijken van voldoende kwaliteit.

![adapter](../Logboek_recources/fastqc/multiqc_ruw_adapter_content.png)
De 90% duplicatie samples hebben ook dramatisch hoge adaptercontent score. dit zou mogelijk een verklaring kunnen zijn van de hoeveelheid duplicaties. 

![duplies](../Logboek_recources/fastqc/multiqc_ruw_dupli_lvl.png)
Dit plot visualiseert de hoeveelheid duplicatie per sequentie. van de eerste 4 samples had ik verwacht dat de piek in duplicaten hoger zou zijn aan het begin vanwege de hoeveelheid adapters. dit zou kunnen hinten naar pcr artefacten.

![overrepresentive](../Logboek_recources/fastqc/multiqc_ruw_overrep_seq.png)


Hieruit kun je zien dat de sample's 527,528,529,530 van zeer slechte kwaliteit zijn. Het meest bijzondere aan deze samples is de absurde hoeveelheid duplicaten hierin.
Bij de individuele fastqc rapporten van de bovenstaande 4 samples heb ik gekeken naar de overrepresented sequences.
In deze lijst stonden een paar sequenties die herkent werden als adapters maar de meesten niet. Ik heb 1 van de sequentie op advies van Ronald geblast.
BLAST is een alignment tool van NCBI en het doel van dit programma is het vergelijkingen van de opgegeven sequentie met de referentie database om te kijken wat opgegeven sequentie is en waarvoor hij misschien zou kunnen zijn. 

Ik heb 1 van de sequentie's die voor 60% verantwoordelijk was voor de duplicatie door 4 blast databasen gehaald en hieruit kwam bij alle 4 geen match.

### Uitkomst Eerste FastQC
Dit alles bij elkaar vindt ik dat we de eerste 4 samples waarschijnlijk niet bruikbaar zijn voor verder onderzoek vanwege hun slechte kwaliteit. de laatste 4 lijken wel van goed genoege kwaliteit te zijn om te gebruiken.
Deze samples scoren goed in de algemene kwaliteit plotten na het trimmen moet er nog wel gekeken worden naar de duplicatie plots om te kijken of daar nog eventuele problemen in kunnen zitten

#### Blast settings
Core nucleotide database
Nucleotide collections 
refseq genome databse (Mus Muscus)
refseq Reference genomes (Mus Muscus)

### Resultaten
FastQC + Multiqc analyse gedaan, bestanden staan in /students/2024-2025/Thema05/3dconformatieChromatine/fastqc_output/

## Woensdag
Het doel van vandaag is samen met storm en Jarno aan het automatische bwa-mem commando werken. 

### mapping bijproduct
Om uit te vinden van wat de 4 eerste samples zijn hadden wij het idee om het sample te mappen tegen een referentie genoom om te kijken wat deze samples zouden kunnen zijn. uiteindelijk hebben wij hier niks mee gedaan vanwege de slechte kwaliteit van deze samples. Dit wordt later in het logboek uitgelegt.
Gezamenlijk zijn wij bezig geweest met het BWA-MEM commando en hebben dit ook gerunt. maar vervolgens hebben wij hier niks me gedaan. de uitleg hiervoor komt later in het bestand


## Vrijdag
Vandaag is het doel om samen met storm het trimmomatic commando af te maken zodat we daar mee kunnen experimenteren voor onze data analyse.

### Trimmomatic settings
minlen 40 
standaard
slidingwindow 4 : 20 
standaard

Trimmomatic command

```{bash eval=FALSE}
cat /students/2024-2025/Thema05/3dconformatieChromatine/SRA/SraAccList.csv | \
  parallel 'TrimmomaticPE -threads 80 ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/fastq/{}_1.fastq ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/fastq/{}_2.fastq ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/Trimmomatic_output/paired/{}_forward_paired.fastq ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/Trimmomatic_output/unpaired/{}_forward_unpaired.fastq ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/Trimmomatic_output/paired/{}_rev_paired.fastq ' \
                  '/students/2024-2025/Thema05/3dconformatieChromatine/Trimmomatic_output/unpaired/{}_rev_unpaired.fastq ' \
                  'ILLUMINACLIP:/students/2024-2025/Thema05/3dconformatieChromatine/Trimmomatic/Trimmomatic-0.39/adapters/TruSeq3-SE.fa:2:30:10 ' \
                  'MINLEN:40 ' \
                  'SLIDINGWINDOW:4:20'
                  'HEADCROP:10'
```

### Resultaten
Functioneel bash script voor trimmen

# Week 3 

## Maandag
Het doel vandaag is besluiten wat we doen met de samples van dramatisch slechte kwaliteit en met trimmomatic experimenteren. Dit doen we om de data klaar te zetten voor het mappen en alignen.

### Besluit samples
Als groep hebben we besloten om de samples 527,528,529,530 te verwijderen uit verdere pipeline vanwege slechte kwaliteit score op het fastqc rapport en we hebben het sample type wildtipe niet per se nodig voor ons genetisch onderzoek.

### Trimmomatic en FastQC
Trimmomatic 2 pogingen met en zonder de optie headcrop + fastqc en multiqc voor controle van de getrimde data.
verdere opties:
minlen 40

slidingwindow 4:20

circa 95% van de reads per sample overleven het als gepaarde read.
In de trimmomatic output stond dat het headcrop argument was gefaald en niet is meegenomen in het trimmen.
![general stats trimd](../Logboek_recources/fastqc/multiqc_trimd_gen_stats.png)
Bij de standaard statistieken zie ik dat de CG percentages iets uit elkaar liggen mijn eerste gedachte hierbij was dat de samples misschien gecontamineerd is maar volgens Ronald is het normaal dat CG% 1% of 2% uit elkaar kunnen liggen aan de hand van het type cell dus dit hoeft geen probleem te zijn. 
Het gemmiddelde CG percentage van een muis is 42% (GRCm39 reffrence genome. https://www.ncbi.nlm.nih.gov/datasets/genome/GCF_000001635.27/). Het chromosome met het hoogste CG% is 44% op chromosome 11. 
Dit is ook het chromosome waar het Ebf1 gen op ligt dat gebruikt is in het onderzoek. (https://www.ncbi.nlm.nih.gov/gene/13591)
Onze samples hebben een gemiddelde CG percentage van 45,75 deze informatie bevestigt ons idee dat dit onderzoek geen whole genome sequencing heeft gedaan maar een selectie heeft gemaakt en dit waarschijnlijk heeft geampliceerd met de aaname dat dit choromosme 11 is met de reden dat hier het Ebf1 gen op ligt dat critiek is bij dit onderzoek.
De hoeveelheid duplicaties kan hiermee deels verklaart worden.

![general stats](../Logboek_recources/fastqc/multiqc_trimd_seq_quality.png)
Zoals hier te zien is de gemiddelde kwaliteit van deze samples wel goed het piek omhoog aan het eind is resultaat van het trimmen.

![general stats](../Logboek_recources/fastqc/multiqc_trimd_leng_distri.png)
Het opvallende hier is dat er een piek aan het begin bij circa 10 readlengt. dit hoort niet te kunnen aangezien hij alle reads onder 40 in lengte door trimmomatic had moeten verwijderen. Trimmomatic had ook geen error aangegeven dat het minlen argument was gefaald of niet gevonden was.

![general stats](../Logboek_recources/fastqc/multiqc_trimd_cg_content.png)
Het CG plot geeft een waarschuwing aan omdat het cg percentage een beetje afwijkt van een normaal verdeling heeft.
Aangezien er geen scherpe pieken zijn in deze grafiek betekent het dat de samples in elk geval niet gecontamineerd zijn. 
Voor het trimmen gaven deze samples ook al een waarschuwing van fastqc vanwege de afwijking in deviatie. Zoals ik bij de de standaard statistiek plot heb uitgezocht ben ik van mening dat ook al is de grafiek niet netjes denk ik dat het niet een significant probleem is voor ons verdere onderzoek.

Overrepresented sequences
Hier is geen plot voor maar het gaf een waarschuwing aan bij de 4 reverse paired reads. hier zal ik morgen naar kijken en eventueel met ronald overleggen omdat ik het raar vind dat dit alleen voorkomt bij de reverse paired reads.

Adapter content
hier is ook geen plot meer voor omdat er geen adapters meer gevonden zijn.  

## Dinsdag
Het doel van vandaag is overleggen met Ronald over onze onderzoeksvraag en commentaar op de fastqc data.

### Commentaar Fastqc
multiqc overrepresentive sequences. 
Na het bekijken van de individuele fastqc bestanden blijkt dat alle reverse read samples een overrepresentatie hebben van een verlengde GGGGGGG van varieërende lengtes. 
Volgens Ronald kan dit een echt stuk genoom zijn of pcr artifact.
Ik heb 1 van de sequences geblast via (https://blast.ncbi.nlm.nih.gov/Blast.cgi) door de volgende databases (Mus Muscus):
Core nucleotide database.
Nucleotide collections.
Bij beide databases was er geen match en een globale google search om te kijken of er een lange ggg repeat sequentie in het genoom van een muis zit leverde ook geen informatie op.
Dit samen met het feit dat dit deze sequentie alleen wordt aangegeven op de reverse pair reads concludeer ik dat dit hoogstwaarschijnlijk een mechanische fout heeft plaats gevonden tijdens het sequencen.

### Onderzoeksvraag
Als groep hadden wij tot vandaag nog geen onderzoeksvraag. Na overleg met Ronald zijn wij op het volgende gekomen. 
"Zijn er genetische varianten te vinden in het embf1 en pax5 gen te vinden dat het vorige onderzoek kan beinvloeden" die in het genoom van rag2(-/-) muizen

### BWA mapping
via Floris bwa gerund en via Jarno freebayes zie hun logboek

### Freebayes variant calling

## woensdag
logboek review ronald

## Vrijdag
werken aan logboek

# Week 4

## Maandag 
werken aan logboek

# bibliografie 
[1]Fastqc
Versie 0.12
https://www.bioinformatics.babraham.ac.uk/projects/fastqc/

[2]Trimmomatic
Versie 0.39
http://www.usadellab.org/cms/?page=trimmomatic 


